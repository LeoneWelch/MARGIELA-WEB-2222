<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MARGIELA</title>
    <link rel="stylesheet" href="index.css">
    <link rel="stylesheet" href="https://use.typekit.net/tyg0iyw.css">
</head>

<body>
    <div class="intro">
    <div class="videobox">    <video src="Sans titre-4.mp4" muted playsinline preload></video>
    </div>
    <div class="cover"></div>
</div>
    <div class="headerbox">
        <div class="headerleft">
          <p>MAISON MARGIELA</p>
        </div>
      </div>


    <main>
        <section class="mainpage" id="section1">
            <div class="videolanding">
                <video src="YTDown.com_YouTube_Maison-Margiela-Artisanal-Collection-202_Media_gAh7PL-FL-Y_002_720p.mp4" autoplay muted loop></video>
            </div>
            <div class="textglenn">
                <p>L’art flamand (Flandres, Belgique) : Glenn Martens puise<br> dans les maîtres de la peinture flamande pour <br> les imprimés, la texture et la profondeur.</p>
            </div>
        </section>

        <section class="page2">
            <div class="imagerow">
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/01.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/02.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/03.png" alt=""></div>
                </div>
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/04.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/05.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/06.png" alt=""></div>
                </div>
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/07.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/08.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/09.png" alt=""></div>
                </div>
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/10.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/11.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/12.png" alt=""></div>
                </div>
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/13.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/14.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/15.png" alt=""></div>
                </div>
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/16.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/17.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/18.png" alt=""></div>
                </div>
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/19.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/20.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/21.png" alt=""></div>
                </div>
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/22.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/23.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/24.png" alt=""></div>
                </div>
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/25.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/26.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/27.png" alt=""></div>
                </div>
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/28.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/29.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/30.png" alt=""></div>
                </div>
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/31.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/32.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/33.png" alt=""></div>
                </div>
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/34.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/35.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/36.png" alt=""></div>
                </div>
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/37.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/38.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/39.png" alt=""></div>
                </div>
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/40.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/41.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/42.png" alt=""></div>
                </div>
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/43.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/44.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/45.png" alt=""></div>
                </div>
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/46.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/47.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/48.png" alt=""></div>
                </div>
                </div>
            </div>
        </section>
    </main>



    <footer>
        <div class="footerbox">
            <div class="textleft">
                <p>Haute couture<br>
                    Automne/Hiver 2025-2026</p>
            </div>
            <div class="textright">                
                <p class="index"><a href="gallery.html">DETAILS</a></p>
                <p class="Format"><a href="#section1" class="scrollToSection">Maison</a></p>
            </div>
            
        </div>
    </footer>
    <div class="rideaublancpage2"></div>
    <div class="rideau-blanc"></div>

</body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@studio-freight/lenis@1.0.39/dist/lenis.min.js"></script>

<script>
window.addEventListener('load', () => {
  gsap.registerPlugin(ScrollTrigger);

  // --- Sélecteurs ---
  const rideau = document.querySelector('.rideaublancpage2');
  const indexAnchor = document.querySelector('.index a');
  const maisonButton = document.querySelector('.Format a');
  const videoEl = document.querySelector('.videobox video');
  const mainpage = document.querySelector('.mainpage');
  const intro = document.querySelector('.intro');

  // --- Gestion du rideau principal (entre pages) ---
  const playReverse = sessionStorage.getItem('playRideauReverse') === 'true';

  if (rideau) {
    if (playReverse) {
      // On arrive depuis une transition : rideau déjà visible
      gsap.set(rideau, { y: "0%", display: "block" });
      gsap.to(rideau, {
        y: "100%", // disparaît vers le bas
        duration: 0.7,
        ease: "expo.inOut",
        onComplete: () => sessionStorage.removeItem('playRideauReverse')
      });
    } else {
      // Arrivée normale : rideau caché
      gsap.set(rideau, { y: "100%", display: "block" });
    }
  }

  // --- Transition quand on clique sur "Index" ---
  if (indexAnchor && rideau) {
    indexAnchor.addEventListener('click', (e) => {
      e.preventDefault();
      const href = indexAnchor.href;
      sessionStorage.setItem('playRideauReverse', 'true');
      gsap.to(rideau, {
        y: "0%", // le rideau monte pour couvrir
        duration: 0.7,
        ease: "expo.inOut",
        onComplete: () => window.location.href = href
      });
    });
  }

  // --- Intro vidéo + disparition du rideau vers le haut ---
  const hasPlayedIntro = sessionStorage.getItem('introPlayed');

  if (!hasPlayedIntro && videoEl && intro) {
    try { videoEl.pause(); } catch (e) {}

    // Animation de zoom simple sur la vidéo
    const tl = gsap.timeline({ defaults: { ease: "power2.inOut" } });
    tl.fromTo(videoEl, { scale: 0.6 }, {
      delay: 0.5,
      scale: 1,
      duration: 1.8,
      ease: "expo.out",
      onUpdate: () => {
        if (tl.time() >= 1.3 && videoEl.paused) {
          try { videoEl.play(); videoEl.playbackRate = 1; } catch (e) {}
        }
      }
    });

    // Quand la vidéo se termine → attente de 0.5s → rideau monte (bas → haut)
    videoEl.addEventListener("ended", () => {
      gsap.to(intro, {
        y: "-100%",
        duration: 0.7,
        ease: "expo.inOut",
        delay: 0.5, // ⏱ petit délai avant la montée
        onComplete: () => {
          intro.style.display = 'none';
          gsap.set(mainpage, { opacity: 1 });
          sessionStorage.setItem('introPlayed', 'true');
        }
      });
    });

    // Sécurité : si la vidéo est déjà terminée
    if (videoEl.ended) {
      gsap.to(intro, {
        y: "-100%",
        duration: 0.7,
        ease: "expo.inOut",
        delay: 0.5, // même délai ici
        onComplete: () => {
          intro.style.display = 'none';
          gsap.set(mainpage, { opacity: 1 });
          sessionStorage.setItem('introPlayed', 'true');
        }
      });
    }

  } else {
    // Si l’intro a déjà été jouée
    if (intro) intro.style.display = 'none';
    if (mainpage) gsap.set(mainpage, { opacity: 1 });
  }

  // --- Smooth scroll avec Lenis ---
  const lenis = new Lenis({
    duration: 0.9,
    easing: (t) => 1 - Math.pow(1 - t, 2),
    smoothWheel: true,
    smoothTouch: false,
  });

  lenis.on('scroll', ScrollTrigger.update);
  (function raf(time){ lenis.raf(time); requestAnimationFrame(raf); })();

  // --- Scroll fluide vers section1 (bouton “Maison”) ---
  if (maisonButton) {
    maisonButton.addEventListener('click', (e) => {
      e.preventDefault();
      const target = document.querySelector('#section1');
      if (target) {
        lenis.scrollTo(target, {
          offset: 0,
          duration: 1.6,
          easing: gsap.parseEase("expo.inOut")
        });
      }
    });
  }

  // --- Changement de couleur du texte au scroll ---
  if (document.querySelector('.page2')) {
    ScrollTrigger.create({
      trigger: ".page2",
      start: "top center",
      onEnter: () => switchTextColor("black"),
      onLeaveBack: () => switchTextColor("white")
    });
  }

  function switchTextColor(color) {
    gsap.to(
      [
        ".headerleft p",
        ".footerbox",
        ".textglenn",
        ".textright a",
        ".textright p",
        ".textleft p"
      ],
      { color: color, duration: 0.7, ease: "power3.inOut" }
    );
  }

});

// --- Positionne .textglenn 1vh sous le bas du titre, tout le temps ---
(function () {
  const glenn = document.querySelector('.textglenn');
  const title = document.querySelector('.headerleft p');
  if (!glenn || !title) return;

  const OFFSET_VH = 3; // 1vh en dessous du titre

  function pxFromVh(vh) { return window.innerHeight * (vh / 100); }

  function place() {
    const rect = title.getBoundingClientRect();  // titre = position FIXED => rect relatif au viewport
    const y = rect.bottom + pxFromVh(OFFSET_VH); // bas du titre + 1vh
    glenn.style.position = 'fixed';
    glenn.style.top = Math.round(y) + 'px';
    glenn.style.bottom = 'auto';
    glenn.style.zIndex = '1000'; // au-dessus du titre si besoin
  }

  // 1) Appel immédiat
  place();

  // 2) Quand les polices sont prêtes (la taille du titre peut changer)
  if (document.fonts && document.fonts.ready) {
    document.fonts.ready.then(place).catch(()=>{});
  }

  // 3) Resize / orientation / fullscreen
  window.addEventListener('resize', place);
  window.addEventListener('orientationchange', place);
  ['fullscreenchange','webkitfullscreenchange','mozfullscreenchange','MSFullscreenChange']
    .forEach(evt => document.addEventListener(evt, place));

  // 4) Si le titre change de dimensions (wrap, etc.)
  if ('ResizeObserver' in window) {
    const ro = new ResizeObserver(place);
    ro.observe(title);
  }

  // 5) Si tu as un rideau/intro qui disparaît, recalcule après son changement
  const intro = document.querySelector('.intro');
  if (intro && 'MutationObserver' in window) {
    const mo = new MutationObserver(place);
    mo.observe(intro, { attributes: true, attributeFilter: ['style','class'] });
  }
})();

  
</script>




    

  </body>
  </html>