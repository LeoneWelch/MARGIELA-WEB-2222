<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MARGIELA</title>
    <link rel="stylesheet" href="index.css">
    <link rel="stylesheet" href="https://use.typekit.net/tyg0iyw.css">
</head>

<body>
    <div class="intro">
    <div class="videobox">    <video src="Sans titre-4.mp4" muted playsinline preload></video>
    </div>
    <div class="cover"></div>
</div>
    <div class="headerbox">
        <div class="headerleft">
          <p>MAISON MARGIELA</p>
        </div>
      </div>


    <main>
        <section class="mainpage" id="section1">
            <div class="videolanding">
                <video src="YTDown.com_YouTube_Maison-Margiela-Artisanal-Collection-202_Media_gAh7PL-FL-Y_002_720p.mp4" autoplay muted loop></video>
            </div>
            <div class="textglenn">
                <p>L‚Äôart flamand (Flandres, Belgique) : Glenn Martens puise<br> dans les ma√Ætres de la peinture flamande pour <br> les imprim√©s, la texture et la profondeur.</p>
            </div>
        </section>

        <section class="page2">
            <div class="imagerow">
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/01.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/02.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/03.png" alt=""></div>
                </div>
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/04.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/05.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/06.png" alt=""></div>
                </div>
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/07.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/08.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/09.png" alt=""></div>
                </div>
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/10.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/11.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/12.png" alt=""></div>
                </div>
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/13.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/14.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/15.png" alt=""></div>
                </div>
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/16.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/17.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/18.png" alt=""></div>
                </div>
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/19.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/20.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/21.png" alt=""></div>
                </div>
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/22.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/23.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/24.png" alt=""></div>
                </div>
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/25.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/26.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/27.png" alt=""></div>
                </div>
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/28.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/29.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/30.png" alt=""></div>
                </div>
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/31.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/32.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/33.png" alt=""></div>
                </div>
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/34.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/35.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/36.png" alt=""></div>
                </div>
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/37.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/38.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/39.png" alt=""></div>
                </div>
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/40.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/41.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/42.png" alt=""></div>
                </div>
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/43.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/44.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/45.png" alt=""></div>
                </div>
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/46.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/47.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/48.png" alt=""></div>
                </div>
                </div>
            </div>
        </section>
    </main>



    <footer>
        <div class="footerbox">
            <div class="textleft">
                <p>Haute couture<br>
                    Automne/Hiver 2025-2026</p>
            </div>
            <div class="textright">                
                <p class="index"><a href="gallery.html">DETAILS</a></p>
                <p class="Format"><a href="#section1" class="scrollToSection">Maison</a></p>
            </div>
            
        </div>
    </footer>
    <div class="rideaublancpage2"></div>
    <div class="rideau-blanc"></div>

</body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@studio-freight/lenis@1.0.39/dist/lenis.min.js"></script>

<script>
window.addEventListener('load', () => {
  gsap.registerPlugin(ScrollTrigger);

  // --- S√©lecteurs ---
  const rideau = document.querySelector('.rideaublancpage2');
  const indexAnchor = document.querySelector('.index a');
  const maisonButton = document.querySelector('.Format a');
  const videoEl = document.querySelector('.videobox video');
  const mainpage = document.querySelector('.mainpage');
  const intro = document.querySelector('.intro');

  // --- Gestion du rideau principal (entre pages) ---
  const playReverse = sessionStorage.getItem('playRideauReverse') === 'true';

  if (rideau) {
    if (playReverse) {
      // On arrive depuis une transition : rideau d√©j√† visible
      gsap.set(rideau, { y: "0%", display: "block" });
      gsap.to(rideau, {
        y: "100%", // dispara√Æt vers le bas
        duration: 0.7,
        ease: "expo.inOut",
        onComplete: () => sessionStorage.removeItem('playRideauReverse')
      });
    } else {
      // Arriv√©e normale : rideau cach√©
      gsap.set(rideau, { y: "100%", display: "block" });
    }
  }

  // --- Transition quand on clique sur "Index" ---
  if (indexAnchor && rideau) {
    indexAnchor.addEventListener('click', (e) => {
      e.preventDefault();
      const href = indexAnchor.href;
      sessionStorage.setItem('playRideauReverse', 'true');
      gsap.to(rideau, {
        y: "0%", // le rideau monte pour couvrir
        duration: 0.7,
        ease: "expo.inOut",
        onComplete: () => window.location.href = href
      });
    });
  }

  // --- Intro vid√©o + disparition du rideau vers le haut ---
  const hasPlayedIntro = sessionStorage.getItem('introPlayed');

  if (!hasPlayedIntro && videoEl && intro) {
    try { videoEl.pause(); } catch (e) {}

    // Animation de zoom simple sur la vid√©o
    const tl = gsap.timeline({ defaults: { ease: "power2.inOut" } });
    tl.fromTo(videoEl, { scale: 0.6 }, {
      delay: 0.5,
      scale: 1,
      duration: 1.8,
      ease: "expo.out",
      onUpdate: () => {
        if (tl.time() >= 1.3 && videoEl.paused) {
          try { videoEl.play(); videoEl.playbackRate = 1; } catch (e) {}
        }
      }
    });

    // Quand la vid√©o se termine ‚Üí attente de 0.5s ‚Üí rideau monte (bas ‚Üí haut)
    videoEl.addEventListener("ended", () => {
      gsap.to(intro, {
        y: "-100%",
        duration: 0.7,
        ease: "expo.inOut",
        delay: 0.5, // ‚è± petit d√©lai avant la mont√©e
        onComplete: () => {
          intro.style.display = 'none';
          gsap.set(mainpage, { opacity: 1 });
          sessionStorage.setItem('introPlayed', 'true');
        }
      });
    });

    // S√©curit√© : si la vid√©o est d√©j√† termin√©e
    if (videoEl.ended) {
      gsap.to(intro, {
        y: "-100%",
        duration: 0.7,
        ease: "expo.inOut",
        delay: 0.5, // m√™me d√©lai ici
        onComplete: () => {
          intro.style.display = 'none';
          gsap.set(mainpage, { opacity: 1 });
          sessionStorage.setItem('introPlayed', 'true');
        }
      });
    }

  } else {
    // Si l‚Äôintro a d√©j√† √©t√© jou√©e
    if (intro) intro.style.display = 'none';
    if (mainpage) gsap.set(mainpage, { opacity: 1 });
  }

  // --- Smooth scroll avec Lenis ---
  const lenis = new Lenis({
    duration: 0.9,
    easing: (t) => 1 - Math.pow(1 - t, 2),
    smoothWheel: true,
    smoothTouch: false,
  });

  lenis.on('scroll', ScrollTrigger.update);
  (function raf(time){ lenis.raf(time); requestAnimationFrame(raf); })();

  // --- Scroll fluide vers section1 (bouton ‚ÄúMaison‚Äù) ---
  if (maisonButton) {
    maisonButton.addEventListener('click', (e) => {
      e.preventDefault();
      const target = document.querySelector('#section1');
      if (target) {
        lenis.scrollTo(target, {
          offset: 0,
          duration: 1.6,
          easing: gsap.parseEase("expo.inOut")
        });
      }
    });
  }

  // --- Changement de couleur du texte au scroll ---
  if (document.querySelector('.page2')) {
    ScrollTrigger.create({
      trigger: ".page2",
      start: "top center",
      onEnter: () => switchTextColor("black"),
      onLeaveBack: () => switchTextColor("white")
    });
  }

  function switchTextColor(color) {
    gsap.to(
      [
        ".headerleft p",
        ".footerbox",
        ".textglenn",
        ".textright a",
        ".textright p",
        ".textleft p"
      ],
      { color: color, duration: 0.7, ease: "power3.inOut" }
    );
  }

});



// üîß Corrige la position apr√®s la sortie du plein √©cran
window.addEventListener("resize", () => {
  const glenn = document.querySelector(".textglenn");
  if (glenn) {
    // Force un l√©ger repositionnement pour recalculer le flux
    glenn.style.transform = "translateY(0)";
    setTimeout(() => {
      glenn.style.transform = "translateY(0)"; // r√©applique sa position
    }, 200);
  }
});


(function () {
    const glenn = document.querySelector('.textglenn');
    if (!glenn) return;

    // üîß Choisis la position verticale "visuelle" que tu veux (en % de la hauteur initiale)
    // 0.62 = environ 62% de la hauteur de l‚Äô√©cran (plus grand => plus bas)
    const RATIO_FROM_TOP = 0.545;

    // On m√©morise la hauteur de fen√™tre au premier rendu
    const initialVH = window.innerHeight;

    function lockPositionOnce() {
      const topPx = Math.round(initialVH * RATIO_FROM_TOP);
      glenn.style.top = topPx + 'px';
      glenn.style.bottom = 'auto';
    }

    // Position verrouill√©e d√®s le d√©part
    lockPositionOnce();

    // Quand on sort du plein √©cran, on r√©applique EXACTEMENT la m√™me position pixel
    function reapplyAfterFullscreen() {
      // petit d√©lai pour laisser le viewport se stabiliser
      setTimeout(lockPositionOnce, 200);
    }

    document.addEventListener('fullscreenchange', () => {
      if (!document.fullscreenElement) reapplyAfterFullscreen();
    });
    document.addEventListener('webkitfullscreenchange', () => {
      if (!document.webkitFullscreenElement) reapplyAfterFullscreen();
    });
    document.addEventListener('mozfullscreenchange', () => {
      if (!document.mozFullScreenElement) reapplyAfterFullscreen();
    });
    document.addEventListener('MSFullscreenChange', () => {
      if (!document.msFullscreenElement) reapplyAfterFullscreen();
    });
  })();



  
</script>




    

  </body>
  </html>