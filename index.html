<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MARGIELA</title>
    <link rel="stylesheet" href="index.css">
    <link rel="stylesheet" href="https://use.typekit.net/tyg0iyw.css">
</head>

<body>
    <div class="intro">
    <div class="videobox">    <video src="Sans titre-4.mp4" muted playsinline preload></video>
    </div>
    <div class="cover"></div>
</div>
    <div class="headerbox">
        <div class="headerleft">
          <p>MAISON MARGIELA</p>
        </div>
      </div>


    <main>
        <section class="mainpage" id="section1">
            <div class="videolanding">
                <video src="YTDown.com_YouTube_Maison-Margiela-Artisanal-Collection-202_Media_gAh7PL-FL-Y_002_720p.mp4" autoplay muted loop></video>
            </div>
            <div class="textglenn">
                <p>L’art flamand (Flandres, Belgique) : Glenn Martens puise<br> dans les maîtres de la peinture flamande pour <br> les imprimés, la texture et la profondeur.</p>
            </div>
        </section>

        <section class="page2">
            <div class="imagerow">
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/01.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/02.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/03.png" alt=""></div>
                </div>
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/04.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/05.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/06.png" alt=""></div>
                </div>
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/07.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/08.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/09.png" alt=""></div>
                </div>
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/10.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/11.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/12.png" alt=""></div>
                </div>
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/13.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/14.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/15.png" alt=""></div>
                </div>
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/16.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/17.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/18.png" alt=""></div>
                </div>
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/19.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/20.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/21.png" alt=""></div>
                </div>
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/22.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/23.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/24.png" alt=""></div>
                </div>
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/25.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/26.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/27.png" alt=""></div>
                </div>
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/28.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/29.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/30.png" alt=""></div>
                </div>
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/31.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/32.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/33.png" alt=""></div>
                </div>
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/34.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/35.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/36.png" alt=""></div>
                </div>
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/37.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/38.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/39.png" alt=""></div>
                </div>
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/40.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/41.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/42.png" alt=""></div>
                </div>
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/43.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/44.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/45.png" alt=""></div>
                </div>
                <div class="row1">
                    <div><img src="MARGIELAIMAGES/46.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/47.png" alt=""></div>
                    <div><img src="MARGIELAIMAGES/48.png" alt=""></div>
                </div>
                </div>
            </div>
        </section>
    </main>



    <footer>
        <div class="footerbox">
            <div class="textleft">
                <p>Haute couture<br>
                    Automne/Hiver 2025-2026</p>
            </div>
            <div class="textright">                
                <p class="index"><a href="gallery.html">DETAILS</a></p>
                <p class="Format"><a href="#section1" class="scrollToSection">Maison</a></p>
            </div>
            
        </div>
    </footer>
    <div class="rideaublancpage2"></div>
    <div class="rideau-blanc"></div>

</body>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/@studio-freight/lenis@1.0.39/dist/lenis.min.js"></script>

<script>
document.addEventListener('DOMContentLoaded', () => {
  gsap.registerPlugin(ScrollTrigger);

  // Sélecteurs
  const rideau = document.querySelector('.rideaublancpage2');
  const indexAnchor = document.querySelector('.index a');
  const maisonButton = document.querySelector('.Format a');
  const intro = document.querySelector('.intro');
  const videoEl = document.querySelector('.videobox video');
  const mainpage = document.querySelector('.mainpage');

  // Rideau inter-pages : déjà caché en CSS ; juste gérer la transition si besoin
  const playReverse = sessionStorage.getItem('playRideauReverse') === 'true';
  if (rideau) {
    if (playReverse) {
      gsap.set(rideau, { y: "0%" });
      gsap.to(rideau, {
        y: "100%",
        duration: 0.7,
        ease: "expo.inOut",
        onComplete: () => sessionStorage.removeItem('playRideauReverse')
      });
    } else {
      gsap.set(rideau, { y: "100%" });
    }
  }

  if (indexAnchor && rideau) {
    indexAnchor.addEventListener('click', (e) => {
      e.preventDefault();
      const href = indexAnchor.href;
      sessionStorage.setItem('playRideauReverse', 'true');
      gsap.to(rideau, {
        y: "0%",
        duration: 0.7,
        ease: "expo.inOut",
        onComplete: () => window.location.href = href
      });
    });
  }

  // --- Intro : montre la page même si la vidéo ne joue pas ---
  const hasPlayedIntro = sessionStorage.getItem('introPlayed');

  function showMain() {
    if (!intro) return;
    gsap.to(intro, {
      y: "-100%",
      duration: 0.7,
      ease: "expo.inOut",
      onComplete: () => {
        intro.style.display = 'none';
        if (mainpage) gsap.set(mainpage, { opacity: 1 });
        sessionStorage.setItem('introPlayed', 'true');
      }
    });
  }

  if (!hasPlayedIntro && intro) {
    // Essaye de jouer si une source existe
    if (videoEl && videoEl.getAttribute('src')) {
      try { videoEl.muted = true; videoEl.play().catch(()=>{}); } catch(e){}

      // Si ça joue -> on laissera "ended" fermer l'intro; sinon fallback
      const fallbackTimer = setTimeout(() => {
        if (videoEl.readyState < 2 || videoEl.paused) showMain();
      }, 1500);

      videoEl.addEventListener('playing', () => clearTimeout(fallbackTimer));
      videoEl.addEventListener('error', showMain);
      videoEl.addEventListener('ended', showMain);
    } else {
      // Pas de source vidéo -> ferme après 800 ms pour l'effet
      setTimeout(showMain, 800);
    }
  } else {
    if (intro) intro.style.display = 'none';
    if (mainpage) gsap.set(mainpage, { opacity: 1 });
  }

  // Animation légère sur la vidéo d'intro si présente
  if (videoEl) {
    const tl = gsap.timeline({ defaults: { ease: "power2.inOut" } });
    tl.fromTo(videoEl, { scale: 0.6 }, { delay: 0.2, scale: 1, duration: 1.2, ease: "expo.out" });
  }

  // Lenis smooth scroll
  const lenis = new Lenis({
    duration: 0.9,
    easing: (t) => 1 - Math.pow(1 - t, 2),
    smoothWheel: true,
    smoothTouch: false,
  });
  lenis.on('scroll', ScrollTrigger.update);
  (function raf(time){ lenis.raf(time); requestAnimationFrame(raf); })();

  // Scroll vers #section1
  if (maisonButton) {
    maisonButton.addEventListener('click', (e) => {
      e.preventDefault();
      const target = document.querySelector('#section1');
      if (target) {
        lenis.scrollTo(target, { offset: 0, duration: 1.2, easing: gsap.parseEase("expo.inOut") });
      }
    });
  }

  // Changement de couleur du texte quand .page2 entre
  if (document.querySelector('.page2')) {
    ScrollTrigger.create({
      trigger: ".page2",
      start: "top center",
      onEnter: () => switchTextColor("black"),
      onLeaveBack: () => switchTextColor("white")
    });
  }

  function switchTextColor(color) {
    gsap.to(
      [".headerleft p",".footerbox",".textglenn",".textright a",".textright p",".textleft p"],
      { color, duration: 0.7, ease: "power3.inOut" }
    );
  }

  // Repositionnement texte si resize
  window.addEventListener("resize", () => {
    const glenn = document.querySelector(".textglenn");
    if (glenn) {
      glenn.style.transform = "translateY(0)";
      setTimeout(() => { glenn.style.transform = "translateY(0)"; }, 200);
    }
  });

  // Verrouillage de la position du bloc texte
  (function () {
    const glenn = document.querySelector('.textglenn');
    if (!glenn) return;
    const RATIO_FROM_TOP = 0.545;
    const initialVH = window.innerHeight;
    function lockPositionOnce() {
      const topPx = Math.round(initialVH * RATIO_FROM_TOP);
      glenn.style.top = topPx + 'px';
      glenn.style.bottom = 'auto';
    }
    lockPositionOnce();
    function reapplyAfterFullscreen(){ setTimeout(lockPositionOnce, 200); }
    document.addEventListener('fullscreenchange', () => { if (!document.fullscreenElement) reapplyAfterFullscreen(); });
    document.addEventListener('webkitfullscreenchange', () => { if (!document.webkitFullscreenElement) reapplyAfterFullscreen(); });
    document.addEventListener('mozfullscreenchange', () => { if (!document.mozFullScreenElement) reapplyAfterFullscreen(); });
    document.addEventListener('MSFullscreenChange', () => { if (!document.msFullscreenElement) reapplyAfterFullscreen(); });
  })();

});
</script>





    

  </body>
  </html>